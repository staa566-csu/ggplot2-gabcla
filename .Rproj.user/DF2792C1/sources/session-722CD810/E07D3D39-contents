---
title: "Assignment 1 - ggplot"
author: "Gabrielle Clary"
format: html
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

## Data

The Titles data set was created to list all shows available on Netflix streaming, and analyst the data to find interesting facts. This data was acquired in July 2022 containing data available in the United States.

Data can be found on [Kaggle - Netflix TV Shows and Movies](https://www.kaggle.com/datasets/victorsoeiro/netflix-tv-shows-and-movies?select=titles.csv).

I also tried a few different color options for the graphs to see how they would look in HTML.

### Columns Used:

-   show_type - TV show or movie

-   runtime - the length of the episode (show) or movie

-   imdb_score - score on IMDB

-   imdb_votes -- votes on IMDB

-   tmdb_score - score on TMDB

## R Code

Load data set and create subsets of the data with complete cases for the various variables.

```{r}
library(tidyverse)
library(ggthemes)
library(ggplot2)
library(dplyr)
library(viridis)

titles <- read.csv("titles.csv", header = T)
title2 <- titles[!(is.na(titles$tmdb_score) | titles$tmdb_score==""), ]
title2 <- title2[!(is.na(title2$imdb_score) | title2$imdb_score==""), ]

title3 <- titles[!(is.na(titles$imdb_votes) | titles$imdb_votes==""), ]
title3 <- title3[!(is.na(title3$imdb_score) | title3$imdb_score==""), ]

title4 <- titles[!(is.na(titles$runtime) | titles$runtime==""), ]
title4 <- title4[!(is.na(title4$imdb_score) | title4$imdb_score==""), ]

title5 <- titles[!(is.na(titles$runtime) | titles$runtime==""), ]
title5 <- title5[!(is.na(title5$imdb_votes) | title5$imdb_votes==""), ]
```

## Create Graph 1

First graph, I looked at the relationship between IMDB Score and TMDB Score. I would expect them to have a positive linear trend since both are user rating sites; since the only difference being IMDB has a larger database since it's been around longer.

```{r}
p_titles <- ggplot(data = title2, 
                 mapping = aes(x = imdb_score,
                               y = tmdb_score,
                               color = type)) +
  geom_point() +
  theme_light() +
  theme(legend.position = "none") +
  theme_tufte(base_size=12, base_family = "sans") +
  geom_smooth(method = "loess") +
  scale_x_discrete(name = "IMDB Score", limits = seq(0,10, by = 0.5), breaks = seq(0,10, by = 1)) +
  scale_y_discrete(name = "TMDB Score", limits = seq(0,10, by = 0.5), breaks = seq(0,10, by = 1)) +
  theme(legend.position =  c(0.87, 0.25))

# For some reason could not get the labeling working - adding the legend back in
# line_ends <- ggplot_build(p_titles)$data[[2]] %>% 
#   group_by(colour) %>% 
#   filter(x==max(x))
# #add type label
# line_ends$titles <- title2 %>% pull(type) %>% 
#   unique() %>% 
#   as.character() %>% 
#   sort()
# 
# p_titles <- p_titles + ggrepel::geom_label_repel(data = line_ends,
#                                                  aes(x = 10^line_ends$x,
#                                                      y = line_ends$y,
#                                                      lable = titles),
#                                                  nudge_x = 1,
#                                                  label.size = NA,
#                                                  fill = alpha(c("white"),0))

p_titles <- p_titles + scale_color_colorblind()
p_titles <- p_titles + ggtitle("TMDB Score by IMDB Score by Title Type")
p_titles
```

Here we can see that there is a positive linear trend between the two variables. The coloring is to see if there are nay trends between title types, which it looks like TV Shows tend to have higher scores on both platforms.

## Create Graph 2

My next question is there a relationship between the number of votes that a title gets and the score? I colored it by title type again to see if there any trends for TV Shows vs Movies.

```{r}
p_titles2 <- ggplot(data = title3, 
                 mapping = aes(x = imdb_score,
                               y = imdb_votes,
                               color = type)) +
  geom_point() +
  theme_minimal() +
  theme(legend.position = "none") +
  theme_tufte(base_size=12, base_family = "sans") +
  geom_smooth(method = "loess") +
  scale_x_discrete(name = "IMDB Score", limits = seq(0,10, by = 0.5), breaks = seq(0,10, by = 1)) +
  scale_y_continuous(name = "IMDB Votes") +
  theme(legend.position =  c(.3, .4)) + 
  scale_color_fivethirtyeight() +
  ggtitle("IMDB Votes by IMDB Score by Title Type")
p_titles2
```

It does look like there is a relationship of some type between IMDB Score and IDMB votes; however the trend is reflected in both types of titles.

## Create Graph 3

Well maybe the score is related to how long the title is.

```{r}
p_titles3 <- ggplot(data = title4, 
                 mapping = aes(x = imdb_score,
                               y = runtime,
                               color = type)) +
  geom_point() +
  theme_minimal() +
  theme(legend.position = "none") +
  theme_tufte(base_size=11, base_family = "sans") +
  geom_smooth(method = "loess") +
  scale_x_discrete(name = "IMDB Score", limits = seq(0,10, by = 0.5), breaks = seq(0,10, by = 1)) +
  scale_y_continuous(name = "Runtime") +
  theme(legend.position =  c(.25, .8)) + 
  scale_color_few() +
  ggtitle("Runtime by IMDB Score by Title Type")
p_titles3
```

It seems that there is a pretty good spread of scores for runtimes across title type. I don't think there is relationship worth looking to between these two variables.

## Create Graph 4

Same question as graph 3, except looking at IMDB Votes with runtime. Maybe the longer the move the less votes because not everyone can make it through long titles.

```{r}
p_titles4 <- ggplot(data = title5, 
                 mapping = aes(x = runtime,
                               y = imdb_votes,
                               color = type)) +
  geom_point() +
  theme_minimal() +
  theme(legend.position = "none") +
  theme_tufte(base_size=12, base_family = "sans") +
  geom_smooth(method = "loess") +
  scale_x_continuous(name = "Runtime") +
  scale_y_continuous(name = "IMDB Votes") +
  theme(legend.position =  c(.15, .7)) + 
  scale_color_discrete() +
  ggtitle("IMDB Votes by Runtime by Title Type")
p_titles4
```

It does look like the shorter the title the more votes it has on IMDB
